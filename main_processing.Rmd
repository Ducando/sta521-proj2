---
title: "521 Project 2"
output: html_document
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(tidyverse)
library(viridis)
library(GGally)

# graph theme object 
theme_settings <- theme_light() + theme(axis.text = element_text(size=8), axis.title = element_text(size = 9), legend.title = element_text(size = 9), plot.title = element_text(size = 10, hjust = 0.5)) 
```

## Section 1 

&nbsp; 

```{r}
# read in files with column names 
names <- c("y_coord", "x_coord", "expert", "ndai", "sd", "corr", "angle_df", 
           "angle_cf", "angle_bf", "angle_af", "angle_an")

imagem1 <- read.table('./data/imagem1.txt', col.names = names)
imagem2 <- read.table('./data/imagem2.txt', col.names = names)
imagem3 <- read.table('./data/imagem3.txt', col.names = names)


# make expert column factor and text version
imagem1 %>%
  mutate(expert = as.factor(expert)) %>%
  mutate(expert_text = ifelse(expert == 0, "unlabeled", ifelse(expert == 1, "cloudy","clear"))) -> imagem1

imagem2 %>%
  mutate(expert = as.factor(expert)) %>%
  mutate(expert_text = ifelse(expert == 0, "unlabeled", ifelse(expert == 1, "cloudy","clear"))) -> imagem2

imagem3 %>%
  mutate(expert = as.factor(expert)) %>%
  mutate(expert_text = ifelse(expert == 0, "unlabeled", ifelse(expert == 1, "cloudy","clear"))) -> imagem3

imagem1 %>%
  bind_rows(imagem2) %>%
  bind_rows(imagem3) -> all

```

&nbsp; 

#### Part B

&nbsp; 

```{r}
# look at percentage for total 
all %>%
  group_by(expert_text) %>%
  summarise(prop_total = round((n() / 345556),2))

# look at percentage for each one 
len1 <- nrow(imagem1)
imagem1 %>%
  group_by(expert_text) %>%
  summarise(prop_total = round((n() / len1),2))

len2 <- nrow(imagem2)
imagem2 %>%
  group_by(expert_text) %>%
  summarise(prop_total = round((n() / len2),2))

len3 <- nrow(imagem3)
imagem3 %>%
  group_by(expert_text) %>%
  summarise(prop_total = round((n() / len3),2))
```


```{r}

# We might want to change the colors here becuase it's hard to distinguish between the blue and the black on the legend

# Image 1
ggplot(imagem1, aes(x = x_coord, y = y_coord, color = expert_text)) + 
  geom_point() + 
  theme_settings + 
  labs(x = "X Coordinate", y = "Y Coordinate", color = "Expert Labels") +
  scale_colour_manual(values = c("darkblue", "black", "lightgrey"))

# Image 2
ggplot(imagem2, aes(x = x_coord, y = y_coord, color = expert_text)) + 
  geom_point() + 
  theme_settings + 
  labs(x = "X Coordinate", y = "Y Coordinate", color = "Expert Labels") +
  scale_colour_manual(values = c("darkblue", "black", "lightgrey"))

# Image 3
ggplot(imagem3, aes(x = x_coord, y = y_coord, color = expert_text)) + 
  geom_point() + 
  theme_settings + 
  labs(x = "X Coordinate", y = "Y Coordinate", color = "Expert Labels") +
  scale_colour_manual(values = c("darkblue", "black", "lightgrey"))
```

&nbsp; 

#### Part C

&nbsp; 

```{r}
# pairwise relationships between features 
# cor(all$ndai, all$corr)

all %>%
  select(ndai:angle_an) %>%
  ggpairs()
```

```{r}
# looking at al the angles 
# all %>%
#   select(angle_df:angle_an) %>%
#   ggpairs()
```


```{r}
# expert labels vs features 
imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = ndai, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = corr, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = sd, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = angle_df, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = angle_cf, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = angle_bf, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = angle_af, fill= expert)) +
  geom_histogram()

imagem1 %>%
  filter(expert != 0) %>%
  ggplot(aes(x = angle_an, fill= expert)) +
  geom_histogram()
```


## Section 2

#### Part A
```{r}
image1_x_min <- min(imagem1$x_coord)
image1_x_max <- max(imagem1$x_coord)
image1_x_step <- (image1_x_max-image1_x_min)/3
image_1_xcord_left <- rep(c(image1_x_min,image1_x_min+image1_x_step,image1_x_min+2*image1_x_step),3)
image_1_xcord_right <- rep(c(image1_x_min+image1_x_step-1,image1_x_min+2*image1_x_step-1,image1_x_max),3)
image1_y_min <- min(imagem1$y_coord)
image1_y_max <- max(imagem1$y_coord)
image1_y_step <- (image1_y_max-image1_y_min)/3
image_1_ycord_top <- c(rep(image1_y_min,3),rep(image1_y_min+image1_y_step,3),rep(image1_y_min+2*image1_y_step,3))
image_1_ycord_bot <- c(rep(image1_y_min+image1_y_step-1,3),rep(image1_y_min+2*image1_y_step-1,3),rep(image1_y_max,3))
image_1_blocks <- tibble(left = image_1_xcord_left, right = image_1_xcord_right,
                         top = image_1_ycord_top, bottom = image_1_ycord_bot)

image2_x_min <- min(imagem2$x_coord)
image2_x_max <- max(imagem2$x_coord)
image2_x_step <- floor((image2_x_max-image2_x_min)/3)
image_2_xcord_left <- rep(c(image2_x_min,image2_x_min+image2_x_step,image2_x_min+2*image2_x_step),3)
image_2_xcord_right <- rep(c(image2_x_min+image2_x_step-1,image2_x_min+2*image2_x_step-1,image2_x_max),3)
image2_y_min <- min(imagem2$y_coord)
image2_y_max <- max(imagem2$y_coord)
image2_y_step <- (image2_y_max-image2_y_min)/3
image_2_ycord_top <- c(rep(image2_y_min,3),rep(image2_y_min+image2_y_step,3),rep(image2_y_min+2*image2_y_step,3))
image_2_ycord_bot <- c(rep(image2_y_min+image2_y_step-1,3),rep(image2_y_min+2*image2_y_step-1,3),rep(image2_y_max,3))
image_2_blocks <- tibble(left = image_2_xcord_left, right = image_2_xcord_right,
                         top = image_2_ycord_top, bottom = image_2_ycord_bot)

image3_x_min <- min(imagem3$x_coord)
image3_x_max <- max(imagem3$x_coord)
image3_x_step <- floor((image3_x_max-image3_x_min)/3)
image_3_xcord_left <- rep(c(image3_x_min,image3_x_min+image3_x_step,image3_x_min+2*image3_x_step),3)
image_3_xcord_right <- rep(c(image3_x_min+image3_x_step-1,image3_x_min+2*image3_x_step-1,image3_x_max),3)
image3_y_min <- min(imagem3$y_coord)
image3_y_max <- max(imagem3$y_coord)
image3_y_step <- (image3_y_max-image3_y_min)/3
image_3_ycord_top <- c(rep(image3_y_min,3),rep(image3_y_min+image3_y_step,3),rep(image3_y_min+2*image3_y_step,3))
image_3_ycord_bot <- c(rep(image3_y_min+image3_y_step-1,3),rep(image3_y_min+2*image3_y_step-1,3),rep(image3_y_max,3))
image_3_blocks <- tibble(left = image_3_xcord_left, right = image_3_xcord_right,
                         top = image_3_ycord_top, bottom = image_3_ycord_bot)
```

```{r}
train_index_1 <- sample(1:9,5)
val_index_1 <- sample(setdiff(1:9,train_index_1),2)
test_index_1 <- setdiff(1:9, c(train_index_1,val_index_1))

train_index_2 <- sample(1:9,5)
val_index_2 <- sample(setdiff(1:9,train_index_2),2)
test_index_2 <- setdiff(1:9, c(train_index_2,val_index_2))

train_index_3 <- sample(1:9,5)
val_index_3 <- sample(setdiff(1:9,train_index_3),2)
test_index_3 <- setdiff(1:9, c(train_index_3,val_index_3))

train_blocks_1 <- image_1_blocks[train_index_1,]
val_blocks_1 <- image_1_blocks[val_index_1,]
test_blocks_1 <- image_1_blocks[test_index_1,]

train_blocks_2 <- image_2_blocks[train_index_2,]
val_blocks_2 <- image_2_blocks[val_index_2,]
test_blocks_2 <- image_2_blocks[test_index_2,]

train_blocks_3 <- image_3_blocks[train_index_3,]
val_blocks_3 <- image_3_blocks[val_index_3,]
test_blocks_3 <- image_3_blocks[test_index_3,]
```

```{r}
# sum of the length train/val/test equals length of dataset

train <- rbind(imagem1[imagem1$x_coord >= train_blocks_1[[1,1]] &
                         imagem1$x_coord <= train_blocks_1[[1,2]]&
                         imagem1$y_coord >= train_blocks_1[[1,3]]&
                         imagem1$y_coord <= train_blocks_1[[1,4]],],
               imagem1[imagem1$x_coord >= train_blocks_1[[2,1]] &
                         imagem1$x_coord <= train_blocks_1[[2,2]]&
                         imagem1$y_coord >= train_blocks_1[[2,3]]&
                         imagem1$y_coord <= train_blocks_1[[2,4]],],
               imagem1[imagem1$x_coord >= train_blocks_1[[3,1]] &
                         imagem1$x_coord <= train_blocks_1[[3,2]]&
                         imagem1$y_coord >= train_blocks_1[[3,3]]&
                         imagem1$y_coord <= train_blocks_1[[3,4]],],
               imagem1[imagem1$x_coord >= train_blocks_1[[4,1]] &
                         imagem1$x_coord <= train_blocks_1[[4,2]]&
                         imagem1$y_coord >= train_blocks_1[[4,3]]&
                         imagem1$y_coord <= train_blocks_1[[4,4]],],
               imagem1[imagem1$x_coord >= train_blocks_1[[5,1]] &
                         imagem1$x_coord <= train_blocks_1[[5,2]]&
                         imagem1$y_coord >= train_blocks_1[[5,3]]&
                         imagem1$y_coord <= train_blocks_1[[5,4]],],
               imagem2[imagem2$x_coord >= train_blocks_2[[1,1]] &
                         imagem2$x_coord <= train_blocks_2[[1,2]]&
                         imagem2$y_coord >= train_blocks_2[[1,3]]&
                         imagem2$y_coord <= train_blocks_2[[1,4]],],
               imagem2[imagem2$x_coord >= train_blocks_2[[2,1]] &
                         imagem2$x_coord <= train_blocks_2[[2,2]]&
                         imagem2$y_coord >= train_blocks_2[[2,3]]&
                         imagem2$y_coord <= train_blocks_2[[2,4]],],
               imagem2[imagem2$x_coord >= train_blocks_2[[3,1]] &
                         imagem2$x_coord <= train_blocks_2[[3,2]]&
                         imagem2$y_coord >= train_blocks_2[[3,3]]&
                         imagem2$y_coord <= train_blocks_2[[3,4]],],
               imagem2[imagem2$x_coord >= train_blocks_2[[4,1]] &
                         imagem2$x_coord <= train_blocks_2[[4,2]]&
                         imagem2$y_coord >= train_blocks_2[[4,3]]&
                         imagem2$y_coord <= train_blocks_2[[4,4]],],
               imagem2[imagem2$x_coord >= train_blocks_2[[5,1]] &
                         imagem2$x_coord <= train_blocks_2[[5,2]]&
                         imagem2$y_coord >= train_blocks_2[[5,3]]&
                         imagem2$y_coord <= train_blocks_2[[5,4]],],
               imagem3[imagem3$x_coord >= train_blocks_3[[1,1]] &
                         imagem3$x_coord <= train_blocks_3[[1,2]]&
                         imagem3$y_coord >= train_blocks_3[[1,3]]&
                         imagem3$y_coord <= train_blocks_3[[1,4]],],
               imagem3[imagem3$x_coord >= train_blocks_3[[2,1]] &
                         imagem3$x_coord <= train_blocks_3[[2,2]]&
                         imagem3$y_coord >= train_blocks_3[[2,3]]&
                         imagem3$y_coord <= train_blocks_3[[2,4]],],
               imagem3[imagem3$x_coord >= train_blocks_3[[3,1]] &
                         imagem3$x_coord <= train_blocks_3[[3,2]]&
                         imagem3$y_coord >= train_blocks_3[[3,3]]&
                         imagem3$y_coord <= train_blocks_3[[3,4]],],
               imagem3[imagem3$x_coord >= train_blocks_3[[4,1]] &
                         imagem3$x_coord <= train_blocks_3[[4,2]]&
                         imagem3$y_coord >= train_blocks_3[[4,3]]&
                         imagem3$y_coord <= train_blocks_3[[4,4]],],
               imagem3[imagem3$x_coord >= train_blocks_3[[5,1]] &
                         imagem3$x_coord <= train_blocks_3[[5,2]]&
                         imagem3$y_coord >= train_blocks_3[[5,3]]&
                         imagem3$y_coord <= train_blocks_3[[5,4]],])

val <- rbind(imagem1[imagem1$x_coord >= val_blocks_1[[1,1]] &
                         imagem1$x_coord <= val_blocks_1[[1,2]]&
                         imagem1$y_coord >= val_blocks_1[[1,3]]&
                         imagem1$y_coord <= val_blocks_1[[1,4]],],
               imagem1[imagem1$x_coord >= val_blocks_1[[2,1]] &
                         imagem1$x_coord <= val_blocks_1[[2,2]]&
                         imagem1$y_coord >= val_blocks_1[[2,3]]&
                         imagem1$y_coord <= val_blocks_1[[2,4]],],
               imagem2[imagem2$x_coord >= val_blocks_2[[1,1]] &
                         imagem2$x_coord <= val_blocks_2[[1,2]]&
                         imagem2$y_coord >= val_blocks_2[[1,3]]&
                         imagem2$y_coord <= val_blocks_2[[1,4]],],
               imagem2[imagem2$x_coord >= val_blocks_2[[2,1]] &
                         imagem2$x_coord <= val_blocks_2[[2,2]]&
                         imagem2$y_coord >= val_blocks_2[[2,3]]&
                         imagem2$y_coord <= val_blocks_2[[2,4]],],
               imagem3[imagem3$x_coord >= val_blocks_3[[1,1]] &
                         imagem3$x_coord <= val_blocks_3[[1,2]]&
                         imagem3$y_coord >= val_blocks_3[[1,3]]&
                         imagem3$y_coord <= val_blocks_3[[1,4]],],
               imagem3[imagem3$x_coord >= val_blocks_3[[2,1]] &
                         imagem3$x_coord <= val_blocks_3[[2,2]]&
                         imagem3$y_coord >= val_blocks_3[[2,3]]&
                         imagem3$y_coord <= val_blocks_3[[2,4]],])

test <- rbind(imagem1[imagem1$x_coord >= test_blocks_1[[1,1]] &
                         imagem1$x_coord <= test_blocks_1[[1,2]]&
                         imagem1$y_coord >= test_blocks_1[[1,3]]&
                         imagem1$y_coord <= test_blocks_1[[1,4]],],
               imagem1[imagem1$x_coord >= test_blocks_1[[2,1]] &
                         imagem1$x_coord <= test_blocks_1[[2,2]]&
                         imagem1$y_coord >= test_blocks_1[[2,3]]&
                         imagem1$y_coord <= test_blocks_1[[2,4]],],
               imagem2[imagem2$x_coord >= test_blocks_2[[1,1]] &
                         imagem2$x_coord <= test_blocks_2[[1,2]]&
                         imagem2$y_coord >= test_blocks_2[[1,3]]&
                         imagem2$y_coord <= test_blocks_2[[1,4]],],
               imagem2[imagem2$x_coord >= test_blocks_2[[2,1]] &
                         imagem2$x_coord <= test_blocks_2[[2,2]]&
                         imagem2$y_coord >= test_blocks_2[[2,3]]&
                         imagem2$y_coord <= test_blocks_2[[2,4]],],
               imagem3[imagem3$x_coord >= test_blocks_3[[1,1]] &
                         imagem3$x_coord <= test_blocks_3[[1,2]]&
                         imagem3$y_coord >= test_blocks_3[[1,3]]&
                         imagem3$y_coord <= test_blocks_3[[1,4]],],
               imagem3[imagem3$x_coord >= test_blocks_3[[2,1]] &
                         imagem3$x_coord <= test_blocks_3[[2,2]]&
                         imagem3$y_coord >= test_blocks_3[[2,3]]&
                         imagem3$y_coord <= test_blocks_3[[2,4]],])
```












